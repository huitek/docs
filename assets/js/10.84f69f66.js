(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{42:function(t,a,s){"use strict";s.r(a);var e=s(0),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_1-文档更新记录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-文档更新记录","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 文档更新记录")]),t._v(" "),s("h2",{attrs:{id:"_1-1-版本记录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-版本记录","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.1 版本记录")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("作者")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("发布日期")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("版本")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("备注")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("Le")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("2019-01-31")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("1.0")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("文档定稿")])])])]),t._v(" "),s("h2",{attrs:{id:"_1-2-问题反馈"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-问题反馈","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.2 问题反馈")]),t._v(" "),s("p",[t._v("如有任何疑问或者问题反馈，请发邮件至 thisiswangle@gmail.com 或者发起 "),s("a",{attrs:{href:"https://github.com/pivaiot/pivaiot-docs/blob/master/src/zh-CN/%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%85%A5/mqtt-json-api.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("issue"),s("OutboundLink")],1)]),t._v(" "),s("h1",{attrs:{id:"_2-概要"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-概要","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 概要")]),t._v(" "),s("h2",{attrs:{id:"_2-1-mqtt-协议介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-mqtt-协议介绍","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.1 MQTT 协议介绍")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://mqtt.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MQTT"),s("OutboundLink")],1),t._v(" 是一个轻量级的发布订阅消息传输协议，非常适合物联网各类设备使用。 物联网平台提供功能完整的 MQTT 接入，支持 QoS 0/1/2，并且预置了一系列 Topic，以便快速接入系统。")]),t._v(" "),s("h2",{attrs:{id:"_2-2-mqtt-客户端和编程库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-mqtt-客户端和编程库","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.2 MQTT 客户端和编程库")]),t._v(" "),s("ul",[s("li",[t._v("mosquitto(客户端/服务器端/编程库)")]),t._v(" "),s("li",[t._v("paho-mqtt(Python)")]),t._v(" "),s("li",[t._v("MQTT.js(Javascript)")]),t._v(" "),s("li",[t._v("eclipse paho(Java)")])]),t._v(" "),s("h2",{attrs:{id:"_2-3-连接-mqtt-服务器-mqtt-connect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-连接-mqtt-服务器-mqtt-connect","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.3 连接 MQTT 服务器(MQTT Connect)")]),t._v(" "),s("p",[t._v("使用设备 did (作为 username)和密钥（作为 passowrd）连接 MQTT 服务器，服务器将会返回状态码和消息内容给客户端，包括：")]),t._v(" "),s("ul",[s("li",[t._v("0x00, Connected, 登录成功")]),t._v(" "),s("li",[t._v("0x01, Connection Refused, miss username or password or not match, 登录失败")])]),t._v(" "),s("h1",{attrs:{id:"_3-数据接入接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-数据接入接口","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 数据接入接口")]),t._v(" "),s("h2",{attrs:{id:"_3-1-json-数据格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-json-数据格式","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.1 JSON 数据格式")]),t._v(" "),s("p",[t._v("单条数据上传")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"p9iLhSAxU5t9jnwMnBiJFX"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1549006220220")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// UNIX 时间戳，单位是毫秒")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stringkey1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"doubleKey2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.3333")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"longKey3"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"boolKey4"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("多条数据上传(批量)")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"p9iLhSAxU5t9jnwMnBiJFX"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1549006220220")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// UNIX 时间戳，单位是毫秒")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stringkey1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"doubleKey2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12.3333")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"longKey3"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("89")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"boolKey4"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("did")]),t._v(" 和 "),s("code",[t._v("ts")]),t._v(" 字段是必传字段，其它字段将根据数据点定义清空进行上传")]),t._v(" "),s("li",[t._v("若上传的字段没有定义，服务器将会忽略这个字段, 未来可能会启用严格模式，即上传消息中存在未定义字段，将会舍弃当前整个消息")])]),t._v(" "),s("h2",{attrs:{id:"_3-2-数据上传接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-数据上传接口","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.2 数据上传接口")]),t._v(" "),s("p",[t._v("数据上传接口需要使用平台内置的 topic, 如下：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("/v"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/devices/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("did"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/data\n")])])]),s("p",[t._v("例如设备(p9iLhSAxU5t9jnwMnBiJFX)有以下几个数据点:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("键值")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("数据类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("读写类型")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("示例")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("ir1")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("红外信号 1")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("INTEGER")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("只读（设备只上报）")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("11")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("ir2")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("红外信号 2")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("INTEGER")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("只读（设备只上报）")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("12")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("smoke")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("烟感信息")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("INTEGER")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("只读（设备只上报）")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("0")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("battery_remaining")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("电池剩余电量")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("INTEGER")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("只读（设备只上报）")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("6330")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("feedback")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("反馈信号")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("BOOL")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("只读（设备只上报）")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("false")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("light_on")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("指示灯")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("BOOL")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("读写")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("false")])])])]),t._v(" "),s("p",[t._v("上传数据格式如下：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"p9iLhSAxU5t9jnwMnBiJFX"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1549006220220")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"smoke"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"battery_remaining"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6330")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feedback"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("或者通过网关一次上传多个设备的数据:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"p9iLhSAxU5t9jnwMnBiJFX"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1549006220220")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"smoke"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"battery_remaining"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6330")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feedback"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"p9iLhSAxU5t9jnwMnBiJFY"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1549006220220")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"smoke"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"battery_remaining"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6330")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feedback"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"_3-3-数据点控制接口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-数据点控制接口","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.3 数据点控制接口")]),t._v(" "),s("p",[t._v("平台提供数据控制接口以便控制设备，包括：")]),t._v(" "),s("ul",[s("li",[t._v("设置设备数据点的值（可以使用数据上传接口）")]),t._v(" "),s("li",[t._v("获取设备数据点当前的值")]),t._v(" "),s("li",[t._v("订阅设备数据点的变化(一般是读写类型的数据点)")])]),t._v(" "),s("h3",{attrs:{id:"_3-3-1-设置设备数据点的值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-设置设备数据点的值","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.3.1 设置设备数据点的值")]),t._v(" "),s("p",[t._v("使用设备数据上传接口")]),t._v(" "),s("h3",{attrs:{id:"_3-3-2-获取设备数据点当前的值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-获取设备数据点当前的值","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.3.2 获取设备数据点当前的值")]),t._v(" "),s("p",[t._v("发送消息到 topic")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("/v"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/devices/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("did"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/data_points/request/$request_id\n")])])]),s("p",[t._v("设备订阅 topic，可以获取设备的返回数据")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("/v"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/devices/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("did"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/data_points/response/+\n")])])]),s("p",[t._v("例如数据为:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"did"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"p9iLhSAxU5t9jnwMnBiJFX"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1549006220220")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ir2"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"smoke"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"battery_remaining"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6330")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feedback"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-3-3-订阅数据点变化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-订阅数据点变化","aria-hidden":"true"}},[t._v("#")]),t._v(" 3.3.3 订阅数据点变化")]),t._v(" "),s("p",[t._v("设备订阅 topic")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[t._v("/v"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/devices/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("did"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("/data_points\n\n")])])]),s("p",[t._v("一旦数据点被改变，设备立即可以接收到变化的数据")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('{\n    "data": {\n        "did": "p9iLhSAxU5t9jnwMnBiJFX",\n        "ts": 1549006220220,\n        "light_on": false\n    }\n}\n')])])]),s("p",[t._v("(完)")])])},[],!1,null,null,null);a.default=n.exports}}]);